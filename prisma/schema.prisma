// Prisma Schema for NodCord
// Generated to mirror the Mongoose models with production-grade defaults and constraints

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum BugSeverity {
  LOW    @map("Low")
  MEDIUM @map("Medium")
  HIGH   @map("High")
}

enum BugStatus {
  OPEN        @map("Open")
  IN_PROGRESS @map("In Progress")
  RESOLVED    @map("Resolved")
  CLOSED      @map("Closed")
}

enum ChatType {
  MEMBER_TO_MEMBER       @map("member_to_member")
  MEMBER_TO_ORGANIZATION @map("member_to_organization")
  MEMBER_TO_GROUP        @map("member_to_group")
}

enum CustomerOrderStatus {
  PENDING   @map("Pending")
  SHIPPED   @map("Shipped")
  DELIVERED @map("Delivered")
  CANCELLED @map("Cancelled")
}

enum FavoriteType {
  PROJECT @map("project")
  PRODUCT @map("product")
  TASK    @map("task")
  COMPANY @map("company")
}

enum FeatureStatus {
  PLANNED     @map("Planned")
  IN_PROGRESS @map("In Progress")
  COMPLETED   @map("Completed")
}

enum LogLevel {
  INFO  @map("info")
  WARN  @map("warn")
  ERROR @map("error")
}

enum OrderStatus {
  PENDING   @map("Pending")
  SHIPPED   @map("Shipped")
  DELIVERED @map("Delivered")
}

enum PaymentMethod {
  CREDIT_CARD   @map("credit_card")
  APPLE_PAY     @map("apple_pay")
  GOOGLE_PAY    @map("google_pay")
  AMAZON_PAY    @map("amazon_pay")
  STRIPE        @map("stripe")
  PAYPAL        @map("paypal")
  BANK_TRANSFER @map("bank_transfer")
}

enum PaymentStatus {
  PENDING   @map("pending")
  COMPLETED @map("completed")
  FAILED    @map("failed")
}

enum PriorityLevel {
  LOW    @map("Low")
  MEDIUM @map("Medium")
  HIGH   @map("High")
}

enum ProjectStatus {
  NOT_STARTED @map("Not Started")
  IN_PROGRESS @map("In Progress")
  COMPLETED   @map("Completed")
  ON_HOLD     @map("On Hold")
}

enum ReturnStatus {
  REQUESTED @map("Requested")
  APPROVED  @map("Approved")
  REJECTED  @map("Rejected")
  COMPLETED @map("Completed")
}

enum SharePlatform {
  FACEBOOK @map("Facebook")
  TWITTER  @map("Twitter")
  LINKEDIN @map("LinkedIn")
  OTHER    @map("Other")
}

enum StoryStatus {
  BACKLOG     @map("Backlog")
  IN_PROGRESS @map("In Progress")
  COMPLETED   @map("Completed")
}

enum TaskCategory {
  DEVELOPMENT @map("development")
  MARKETING   @map("marketing")
  DESIGN      @map("design")
  MANAGEMENT  @map("management")
  OTHER       @map("other")
}

enum TaskStatus {
  PENDING     @map("pending")
  IN_PROGRESS @map("in-progress")
  COMPLETED   @map("completed")
  ON_HOLD     @map("on-hold")
}

enum TeamStatus {
  ACTIVE   @map("active")
  INACTIVE @map("inactive")
}

enum TeamType {
  PROJECT    @map("project")
  DEPARTMENT @map("department")
  ESPORTS    @map("esports")
  OTHER      @map("other")
}

enum TicketStatus {
  OPEN   @map("open")
  CLOSED @map("closed")
}

enum UserRole {
  USER      @map("user")
  ADMIN     @map("admin")
  MODERATOR @map("moderator")
}

enum TenantStatus {
  ONBOARDING @map("onboarding")
  ACTIVE     @map("active")
  SUSPENDED  @map("suspended")
  CANCELLED  @map("cancelled")
}

enum AuditAction {
  CREATED             @map("created")
  UPDATED             @map("updated")
  DELETED             @map("deleted")
  ACCESSED            @map("accessed")
  LOGIN               @map("login")
  LOGOUT              @map("logout")
  PERMISSION_CHANGED  @map("permission_changed")
  SECURITY_EVENT      @map("security_event")
  SYSTEM_CONFIGURATION @map("system_configuration")
}

enum EnvironmentType {
  PRODUCTION  @map("production")
  STAGING     @map("staging")
  DEVELOPMENT @map("development")
  TEST        @map("test")
}

enum OAuthProvider {
  GITHUB @map("github")
  GOOGLE @map("google")
}

enum PhoneNumberType {
  MOBILE   @map("mobile")
  LANDLINE @map("landline")
  BUSINESS @map("business")
}

enum SocialLinkType {
  FACEBOOK  @map("facebook")
  TWITTER   @map("twitter")
  GOOGLE    @map("google")
  LINKEDIN  @map("linkedin")
  INSTAGRAM @map("instagram")
  GITHUB    @map("github")
  DISCORD   @map("discord")
}

enum UserPaymentMethodType {
  CREDIT_CARD @map("creditCard")
  DEBIT_CARD  @map("debitCard")
  PAYPAL      @map("paypal")
}

enum ChatParticipantType {
  USER         @map("user")
  ORGANIZATION @map("organization")
  GROUP        @map("group")
  EXTERNAL     @map("external")
}

enum MembershipEventType {
  ADDED   @map("added")
  UPDATED @map("updated")
  REMOVED @map("removed")
}

model Tenant {
  id                String   @id @default(uuid())
  slug              String   @unique
  name              String
  status            TenantStatus @default(ONBOARDING)
  plan              String   @default("free")
  metadata          Json     @default("{}")
  timezone          String   @default("UTC")
  billingEmail      String?
  technicalContact  String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  deletedAt         DateTime?

  apiKeys        ApiKey[]
  apiSystems     ApiSystem[]
  auditLogs      AuditLog[]
  betaSystems    BetaSystem[]
  blogs          Blog[]
  companies      Company[]
  customerOrders CustomerOrder[]
  customers      Customer[]
  dataRetentionPolicies DataRetentionPolicy[]
  feedback       Feedback[]
  orders         Order[]
  organizations  Organization[]
  payments       Payment[]
  products       Product[]
  projects       Project[]
  systemSettings SystemSetting[]
  tasks          Task[]
  teams          Team[]
  tickets        Ticket[]
  users          User[]
  versions       Version[]
  versionTags    VersionTag[]
  metadataRecords TenantMetadata[]

  @@index([status], map: "idx_tenant_status")
  @@index([createdAt], map: "idx_tenant_created_at")
  @@map("Tenant")
}

model TenantMetadata {
  id        String   @id @default(uuid())
  tenantId  String
  key       String
  value     Json     @default("null")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  tenant Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId], map: "idx_tenant_metadata_tenant")
  @@unique([tenantId, key], map: "uq_tenant_metadata_key")
  @@map("TenantMetadata")
}

model AuditLog {
  id         String      @id @default(uuid())
  tenantId   String
  actorId    String?
  entityName String
  entityId   String
  action     AuditAction
  changes    Json        @default("{}")
  ipAddress  String?
  userAgent  String?
  context    Json        @default("{}")
  createdAt  DateTime    @default(now())

  tenant Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  actor  User?  @relation("UserAuditLogs", fields: [actorId], references: [id], onDelete: SetNull)

  @@index([tenantId, entityName, entityId], map: "idx_audit_entity")
  @@index([createdAt], map: "idx_audit_created_at")
  @@map("AuditLog")
}

model SystemSetting {
  id          String          @id @default(uuid())
  tenantId    String
  environment EnvironmentType @default(PRODUCTION)
  key         String
  value       Json            @default("{}")
  description String?         @db.Text
  isSensitive Boolean         @default(false)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt

  tenant Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, environment, key], map: "uq_system_setting_composite")
  @@index([tenantId, environment], map: "idx_system_setting_tenant_env")
  @@map("SystemSetting")
}

model DataRetentionPolicy {
  id            String   @id @default(uuid())
  tenantId      String
  modelName     String
  retentionDays Int      @default(365)
  isActive      Boolean  @default(true)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  tenant Tenant @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, modelName], map: "uq_retention_model")
  @@index([tenantId], map: "idx_retention_tenant")
  @@map("DataRetentionPolicy")
}

model Afk {
  id        String   @id @default(uuid())
  user      String   @map("User")
  guild     String   @map("Guild")
  message   String?  @map("Message")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([guild, user])
  @@map("AFK")
}

model Antilink {
  id        String   @id @default(uuid())
  guild     String   @map("Guild")
  perms     String   @map("Perms")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([guild])
  @@map("Antilink")
}

model ApiKey {
  id        String   @id @default(uuid())
  userId    String
  name      String
  key       String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  expiresAt DateTime
  tenantId  String?
  lastUsedAt DateTime?
  metadata  Json     @default("{}")

  user User @relation("UserApiKeys", fields: [userId], references: [id], onDelete: Cascade)
  primaryOwner User? @relation("UserPrimaryApiKey")
  tenant Tenant? @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  metadataRecords ApiKeyMetadata[]

  @@index([userId])
  @@index([tenantId])
  @@index([createdAt])
  @@unique([userId, name], map: "uq_api_key_user_name")
  @@map("ApiKey")
}

model ApiKeyMetadata {
  id       String   @id @default(uuid())
  apiKeyId String
  key      String
  value    Json     @default("null")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  apiKey ApiKey @relation(fields: [apiKeyId], references: [id], onDelete: Cascade)

  @@index([apiKeyId], map: "idx_api_key_metadata_parent")
  @@unique([apiKeyId, key], map: "uq_api_key_metadata_key")
  @@map("ApiKeyMetadata")
}

model ApiSystem {
  id        String   @id @default(uuid())
  isActive  Boolean  @default(true)
  maintenanceMode   Boolean  @default(false)
  maintenanceReason String?  @db.Text
  tenantId  String?
  metadata  Json     @default("{}")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  tenant Tenant? @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  metadataRecords ApiSystemMetadata[]

  @@index([tenantId])
  @@index([createdAt])
  @@map("ApiSystem")
}

model ApiSystemMetadata {
  id          String   @id @default(uuid())
  apiSystemId String
  key         String
  value       Json     @default("null")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  apiSystem ApiSystem @relation(fields: [apiSystemId], references: [id], onDelete: Cascade)

  @@index([apiSystemId], map: "idx_api_system_metadata_parent")
  @@unique([apiSystemId, key], map: "uq_api_system_metadata_key")
  @@map("ApiSystemMetadata")
}

model Autoresponder {
  id            String   @id @default(uuid())
  guildId       String
  autoresponses Json     @default("[]")
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  responseRecords AutoResponderEntry[]

  @@unique([guildId])
  @@map("AutoResponder")
}

model AutoResponderEntry {
  id               String   @id @default(uuid())
  autoresponderId  String
  trigger          String
  response         String   @db.Text
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  autoresponder Autoresponder @relation(fields: [autoresponderId], references: [id], onDelete: Cascade)

  @@index([autoresponderId], map: "idx_autoresponder_entry_parent")
  @@unique([autoresponderId, trigger], map: "uq_autoresponder_trigger")
  @@map("AutoResponderEntry")
}

model Balance {
  id          String   @id @default(uuid())
  userId      String   @unique
  balance     Decimal  @default(100) @db.Decimal(18, 2)
  createdAt   DateTime @default(now())
  lastUpdated DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("Balance")
}

model Ban {
  id        String   @id @default(uuid())
  userId    String
  username  String
  guildId   String
  reason    String
  bannedAt  DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([guildId])
  @@map("Ban")
}

model BetaKey {
  id        String   @id @default(uuid())
  key       String   @unique
  name      String
  isActive  Boolean  @default(true)
  userId    String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User? @relation("UserBetaKeys", fields: [userId], references: [id], onDelete: SetNull)
  primaryOwner User? @relation("UserPrimaryBetaKey")

  @@index([userId])
  @@map("BetaKey")
}

model BetaSystem {
  id        String   @id @default(uuid())
  isActive  Boolean  @default(true)
  tenantId  String?
  metadata  Json     @default("{}")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  tenant Tenant? @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  metadataRecords BetaSystemMetadata[]

  @@index([tenantId])
  @@index([createdAt])
  @@map("BetaSystem")
}

model BetaSystemMetadata {
  id          String   @id @default(uuid())
  betaSystemId String
  key         String
  value       Json     @default("null")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  betaSystem BetaSystem @relation(fields: [betaSystemId], references: [id], onDelete: Cascade)

  @@index([betaSystemId], map: "idx_beta_system_metadata_parent")
  @@unique([betaSystemId, key], map: "uq_beta_system_metadata_key")
  @@map("BetaSystemMetadata")
}

model Blog {
  id                String   @id @default(uuid())
  picture           String?
  title             String
  shortDescription  String
  detailDescription String   @db.Text
  projectId         String?
  author            String
  tags              Json     @default("[]")
  tenantId          String?
  publishedAt       DateTime?
  isArchived        Boolean  @default(false)
  deletedAt         DateTime?
  metadata          Json     @default("{}")
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  project  Project?  @relation(fields: [projectId], references: [id], onDelete: SetNull)
  tenant   Tenant?   @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  comments Comment[]
  likes    Like[]
  dislikes Dislike[]
  shares   Share[]
  tagRecords BlogTag[]
  metadataRecords BlogMetadata[]

  @@index([projectId])
  @@index([tenantId])
  @@index([isArchived])
  @@index([createdAt])
  @@fulltext([title, shortDescription, detailDescription], map: "ft_blog_search")
  @@map("Blog")
}

model BlogMetadata {
  id      String   @id @default(uuid())
  blogId  String
  key     String
  value   Json     @default("null")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  blog Blog @relation(fields: [blogId], references: [id], onDelete: Cascade)

  @@index([blogId], map: "idx_blog_metadata_blog")
  @@unique([blogId, key], map: "uq_blog_metadata_key")
  @@map("BlogMetadata")
}

model BlogTag {
  id      String @id @default(uuid())
  blogId  String
  value   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  blog Blog @relation(fields: [blogId], references: [id], onDelete: Cascade)

  @@index([blogId], map: "idx_blog_tag_blog")
  @@unique([blogId, value], map: "uq_blog_tag_value")
  @@map("BlogTag")
}

model Bug {
  id          String      @id @default(uuid())
  title       String
  description String      @db.Text
  severity    BugSeverity @default(MEDIUM)
  status      BugStatus   @default(OPEN)
  projectId   String
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId])
  @@index([status])
  @@index([severity])
  @@index([createdAt])
  @@map("Bug")
}

model Category {
  id          String   @id @default(uuid())
  name        String   @unique
  description String?  @db.Text
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("Category")
}

model Chat {
  id           String   @id @default(uuid())
  participants Json     @default("[]")
  type         ChatType
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  participantRecords ChatParticipant[]
  messages Message[]

  @@map("Chat")
}

model ChatParticipant {
  id                 String               @id @default(uuid())
  chatId             String
  participantId      String
  participantType    ChatParticipantType  @default(USER)
  userId             String?
  joinedAt           DateTime             @default(now())
  leftAt             DateTime?
  metadata           Json                 @default("{}")
  createdAt          DateTime             @default(now())
  updatedAt          DateTime             @updatedAt

  chat Chat @relation(fields: [chatId], references: [id], onDelete: Cascade)
  user User? @relation("ChatParticipantUser", fields: [userId], references: [id], onDelete: SetNull)

  @@index([chatId], map: "idx_chat_participant_chat")
  @@index([userId], map: "idx_chat_participant_user")
  @@unique([chatId, participantId], map: "uq_chat_participant")
  @@map("ChatParticipant")
}

model Comment {
  id        String   @id @default(uuid())
  content   String   @db.Text
  authorId  String
  blogId    String
  createdAt DateTime @default(now())

  author User @relation(fields: [authorId], references: [id], onDelete: Cascade)
  blog   Blog @relation(fields: [blogId], references: [id], onDelete: Cascade)

  @@index([authorId])
  @@index([blogId])
  @@index([createdAt])
  @@map("Comment")
}

model Company {
  id           String   @id @default(uuid())
  name         String
  description  String   @default("") @db.Text
  industry     String   @default("")
  headquarters String   @default("")
  foundedDate  String   @default("")
  employees    Int      @default(0)
  website      String   @default("")
  tenantId     String?
  isArchived   Boolean  @default(false)
  deletedAt    DateTime?
  metadata     Json     @default("{}")
  createdDate  DateTime @default(now())
  updatedDate  DateTime @updatedAt

  tenant Tenant? @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  metadataRecords CompanyMetadata[]

  @@index([name], map: "idx_company_name")
  @@index([tenantId])
  @@index([isArchived])
  @@unique([tenantId, name], map: "uq_company_tenant_name")
  @@map("Company")
}

model CompanyMetadata {
  id        String   @id @default(uuid())
  companyId String
  key       String
  value     Json     @default("null")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  company Company @relation(fields: [companyId], references: [id], onDelete: Cascade)

  @@index([companyId], map: "idx_company_metadata_company")
  @@unique([companyId, key], map: "uq_company_metadata_key")
  @@map("CompanyMetadata")
}

model Customer {
  id        String   @id @default(uuid())
  name      String
  email     String   @unique
  phone     String?
  address   String?
  tenantId  String?
  isArchived Boolean  @default(false)
  deletedAt DateTime?
  metadata  Json      @default("{}")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  orders         Order[]
  customerOrders CustomerOrder[]
  tenant         Tenant? @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  metadataRecords CustomerMetadata[]

  @@index([tenantId])
  @@index([isArchived])
  @@index([createdAt])
  @@unique([tenantId, email], map: "uq_customer_tenant_email")
  @@map("Customer")
}

model CustomerMetadata {
  id         String   @id @default(uuid())
  customerId String
  key        String
  value      Json     @default("null")
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  customer Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)

  @@index([customerId], map: "idx_customer_metadata_customer")
  @@unique([customerId, key], map: "uq_customer_metadata_key")
  @@map("CustomerMetadata")
}

model CustomerOrder {
  id              String              @id @default(uuid())
  customerId      String
  orderNumber     String              @unique
  orderDate       DateTime            @default(now())
  status          CustomerOrderStatus @default(PENDING)
  items           Json                @default("[]")
  totalAmount     Decimal             @db.Decimal(18, 2)
  shippingAddress String
  billingAddress  String
  tenantId        String?
  isArchived      Boolean             @default(false)
  deletedAt       DateTime?
  metadata        Json                @default("{}")
  createdAt       DateTime            @default(now())
  updatedAt       DateTime            @updatedAt

  customer Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
  tenant   Tenant?  @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  returns  Return[]
  itemRecords CustomerOrderItem[]
  metadataRecords CustomerOrderMetadata[]

  @@index([customerId])
  @@index([tenantId])
  @@index([isArchived])
  @@index([createdAt])
  @@index([status])
  @@unique([tenantId, orderNumber], map: "uq_customer_order_tenant_number")
  @@map("CustomerOrder")
}

model CustomerOrderMetadata {
  id            String   @id @default(uuid())
  customerOrderId String
  key           String
  value         Json     @default("null")
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  customerOrder CustomerOrder @relation(fields: [customerOrderId], references: [id], onDelete: Cascade)

  @@index([customerOrderId], map: "idx_customer_order_metadata_parent")
  @@unique([customerOrderId, key], map: "uq_customer_order_metadata_key")
  @@map("CustomerOrderMetadata")
}

model CustomerOrderItem {
  id         String   @id @default(uuid())
  orderId    String
  productId  String
  quantity   Int      @default(1)
  price      Decimal  @db.Decimal(18, 2)
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  order   CustomerOrder @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product Product       @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([orderId], map: "idx_customer_order_item_order")
  @@index([productId], map: "idx_customer_order_item_product")
  @@unique([orderId, productId], map: "uq_customer_order_item")
  @@map("CustomerOrderItem")
}

model DeveloperProgram {
  id        String   @id @default(uuid())
  userId    String
  isActive  Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("DeveloperProgram")
}

model Dislike {
  id        String   @id @default(uuid())
  userId    String
  blogId    String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  blog Blog @relation(fields: [blogId], references: [id], onDelete: Cascade)

  @@unique([userId, blogId])
  @@index([blogId])
  @@index([createdAt])
  @@map("Dislike")
}

model Favorite {
  id          String       @id @default(uuid())
  userId      String
  type        FavoriteType
  itemId      String
  metadata    Json         @default("{}")
  createdDate DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  metadataRecords FavoriteMetadata[]

  @@index([userId])
  @@index([createdDate])
  @@unique([userId, type, itemId], map: "uq_favorite_user_item")
  @@map("Favorite")
}

model FavoriteMetadata {
  id         String   @id @default(uuid())
  favoriteId String
  key        String
  value      Json     @default("null")
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  favorite Favorite @relation(fields: [favoriteId], references: [id], onDelete: Cascade)

  @@index([favoriteId], map: "idx_favorite_metadata_parent")
  @@unique([favoriteId, key], map: "uq_favorite_metadata_key")
  @@map("FavoriteMetadata")
}

model Feature {
  id          String        @id @default(uuid())
  title       String
  description String        @db.Text
  projectId   String
  status      FeatureStatus @default(PLANNED)
  priority    PriorityLevel @default(MEDIUM)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId])
  @@index([status])
  @@index([priority])
  @@index([createdAt])
  @@map("Feature")
}

model Feedback {
  id           String   @id @default(uuid())
  userId       String
  guildId      String
  feedbackText String   @db.Text
  tenantId     String?
  category     String?
  metadata     Json     @default("{}")
  resolvedAt   DateTime?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  tenant Tenant? @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  metadataRecords FeedbackMetadata[]

  @@index([guildId])
  @@index([tenantId])
  @@index([createdAt])
  @@map("Feedback")
}

model FeedbackMetadata {
  id         String   @id @default(uuid())
  feedbackId String
  key        String
  value      Json     @default("null")
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  feedback Feedback @relation(fields: [feedbackId], references: [id], onDelete: Cascade)

  @@index([feedbackId], map: "idx_feedback_metadata_feedback")
  @@unique([feedbackId, key], map: "uq_feedback_metadata_key")
  @@map("FeedbackMetadata")
}

model File {
  id         String   @id @default(uuid())
  filename   String
  path       String
  url        String?
  size       Int
  mimetype   String
  uploadedAt DateTime @default(now())
  updatedAt  DateTime @updatedAt

  @@unique([path])
  @@map("File")
}

model Game {
  id                String    @id @default(uuid())
  picture           String?
  title             String
  shortDescription  String
  detailDescription String?
  genre             String?
  releaseDate       DateTime?
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  developer         String?
  platforms         Json      @default("[]")
  ratings           Json      @default("[]")

  platformRecords GamePlatformLink[]
  ratingRecords   GameRating[]

  @@map("Game")
}

model GamePlatformLink {
  id        String   @id @default(uuid())
  gameId    String
  platformId String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  game     Game     @relation(fields: [gameId], references: [id], onDelete: Cascade)
  platform Platform @relation(fields: [platformId], references: [id], onDelete: Cascade)

  @@index([gameId], map: "idx_game_platform_game")
  @@index([platformId], map: "idx_game_platform_platform")
  @@unique([gameId, platformId], map: "uq_game_platform")
  @@map("GamePlatformLink")
}

model GameRating {
  id        String   @id @default(uuid())
  gameId    String
  userId    String
  rating    Int      @db.TinyInt
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  game Game @relation(fields: [gameId], references: [id], onDelete: Cascade)
  user User @relation("GameRatingUser", fields: [userId], references: [id], onDelete: Cascade)

  @@index([gameId], map: "idx_game_rating_game")
  @@index([userId], map: "idx_game_rating_user")
  @@unique([gameId, userId], map: "uq_game_rating_user")
  @@map("GameRating")
}

model Group {
  id          String   @id @default(uuid())
  name        String
  description String?
  members     Json     @default("[]")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  memberRecords GroupMember[]

  @@map("Group")
}

model GroupMember {
  id        String   @id @default(uuid())
  groupId   String
  userId    String
  role      String?  @default("member")
  joinedAt  DateTime @default(now())
  leftAt    DateTime?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  group Group @relation(fields: [groupId], references: [id], onDelete: Cascade)
  user  User  @relation(fields: [userId], references: [id], onDelete: Cascade)
  historyRecords GroupMemberHistory[]

  @@index([groupId], map: "idx_group_member_group")
  @@index([userId], map: "idx_group_member_user")
  @@unique([groupId, userId], map: "uq_group_member_user")
  @@map("GroupMember")
}

model GroupMemberHistory {
  id           String              @id @default(uuid())
  groupMemberId String
  eventType    MembershipEventType @default(ADDED)
  actorId      String?
  description  String?             @db.Text
  occurredAt   DateTime            @default(now())
  createdAt    DateTime            @default(now())

  groupMember GroupMember @relation(fields: [groupMemberId], references: [id], onDelete: Cascade)
  actor       User?       @relation("GroupMemberHistoryActor", fields: [actorId], references: [id], onDelete: SetNull)

  @@index([groupMemberId], map: "idx_group_member_history_parent")
  @@index([actorId], map: "idx_group_member_history_actor")
  @@map("GroupMemberHistory")
}

model Issue {
  id          String    @id @default(uuid())
  title       String
  description String    @db.Text
  status      BugStatus @default(OPEN)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  projectId   String

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId])
  @@index([status])
  @@index([createdAt])
  @@map("Issue")
}

model JoinRole {
  id        String   @id @default(uuid())
  guild     String   @map("Guild")
  roleId    String   @map("RoleID")
  roleName  String   @map("RoleName")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([guild, roleId])
  @@map("JoinRole")
}

model Kick {
  id        String   @id @default(uuid())
  userId    String
  username  String
  guildId   String
  reason    String
  kickedAt  DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([guildId])
  @@map("Kick")
}

model Like {
  id        String   @id @default(uuid())
  userId    String
  blogId    String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  blog Blog @relation(fields: [blogId], references: [id], onDelete: Cascade)

  @@unique([userId, blogId])
  @@index([blogId])
  @@index([createdAt])
  @@map("Like")
}

model Log {
  id             String   @id @default(uuid())
  message        String   @db.Text
  level          LogLevel @default(INFO)
  timestamp      DateTime @default(now())
  additionalData Json?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@map("Log")
}

model Message {
  id        String   @id @default(uuid())
  chatId    String
  senderId  String
  content   String   @db.Text
  timestamp DateTime @default(now())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  chat Chat @relation(fields: [chatId], references: [id], onDelete: Cascade)

  @@index([chatId])
  @@map("Message")
}

model Mute {
  id        String    @id @default(uuid())
  guildId   String
  userId    String
  reason    String    @default("No reason provided")
  mutedAt   DateTime  @default(now())
  duration  Int
  unmutedAt DateTime?
  updatedAt DateTime  @updatedAt

  @@index([guildId])
  @@map("Mute")
}

model Newsletter {
  id           String   @id @default(uuid())
  email        String   @unique
  name         String?
  subscribedAt DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@map("Newsletter")
}

model Order {
  id             String      @id @default(uuid())
  customerId     String
  products       Json        @default("[]")
  totalAmount    Decimal     @db.Decimal(18, 2)
  status         OrderStatus @default(PENDING)
  trackingNumber String?
  tenantId       String?
  isArchived     Boolean     @default(false)
  deletedAt      DateTime?
  metadata       Json        @default("{}")
  createdAt      DateTime    @default(now())
  updatedAt      DateTime    @updatedAt

  customer Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
  tenant   Tenant?  @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  orderItems OrderItem[]
  metadataRecords OrderMetadata[]

  @@index([customerId])
  @@index([tenantId])
  @@index([status])
  @@index([isArchived])
  @@index([createdAt])
  @@map("Order")
}

model OrderMetadata {
  id       String   @id @default(uuid())
  orderId  String
  key      String
  value    Json     @default("null")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  order Order @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@index([orderId], map: "idx_order_metadata_order")
  @@unique([orderId, key], map: "uq_order_metadata_key")
  @@map("OrderMetadata")
}

model OrderItem {
  id        String   @id @default(uuid())
  orderId   String
  productId String
  quantity  Int      @default(1)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  order   Order   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([orderId], map: "idx_order_item_order")
  @@index([productId], map: "idx_order_item_product")
  @@unique([orderId, productId], map: "uq_order_item_product")
  @@map("OrderItem")
}

model Organization {
  id          String   @id @default(uuid())
  name        String
  description String?
  foundedDate DateTime @default(now())
  members     Json     @default("[]")
  tenantId    String?
  isArchived  Boolean  @default(false)
  deletedAt   DateTime?
  metadata    Json     @default("{}")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  tenant Tenant? @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  memberRecords OrganizationMember[]
  metadataRecords OrganizationMetadata[]

  @@index([tenantId])
  @@index([isArchived])
  @@unique([tenantId, name], map: "uq_organization_tenant_name")
  @@index([createdAt])
  @@map("Organization")
}

model OrganizationMetadata {
  id             String   @id @default(uuid())
  organizationId String
  key            String
  value          Json     @default("null")
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)

  @@index([organizationId], map: "idx_organization_metadata_parent")
  @@unique([organizationId, key], map: "uq_organization_metadata_key")
  @@map("OrganizationMetadata")
}

model OrganizationMember {
  id           String   @id @default(uuid())
  organizationId String
  userId       String
  role         String?  @default("member")
  joinedAt     DateTime @default(now())
  leftAt       DateTime?
  metadata     Json     @default("{}")
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  organization Organization @relation(fields: [organizationId], references: [id], onDelete: Cascade)
  user         User          @relation(fields: [userId], references: [id], onDelete: Cascade)
  historyRecords OrganizationMemberHistory[]

  @@index([organizationId], map: "idx_org_member_org")
  @@index([userId], map: "idx_org_member_user")
  @@unique([organizationId, userId], map: "uq_org_member_user")
  @@map("OrganizationMember")
}

model OrganizationMemberHistory {
  id                String              @id @default(uuid())
  organizationMemberId String
  eventType         MembershipEventType @default(ADDED)
  actorId           String?
  description       String?             @db.Text
  occurredAt        DateTime            @default(now())
  createdAt         DateTime            @default(now())

  organizationMember OrganizationMember @relation(fields: [organizationMemberId], references: [id], onDelete: Cascade)
  actor              User?              @relation("OrganizationMemberHistoryActor", fields: [actorId], references: [id], onDelete: SetNull)

  @@index([organizationMemberId], map: "idx_org_member_history_parent")
  @@index([actorId], map: "idx_org_member_history_actor")
  @@map("OrganizationMemberHistory")
}

model Payment {
  id            String        @id @default(uuid())
  userId        String
  amount        Decimal       @db.Decimal(18, 2)
  method        PaymentMethod
  status        PaymentStatus @default(PENDING)
  transactionId String?
  tenantId      String?
  processedAt   DateTime?
  isArchived    Boolean       @default(false)
  deletedAt     DateTime?
  metadata      Json          @default("{}")
  createdDate   DateTime      @default(now())
  updatedAt     DateTime      @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  tenant Tenant? @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  metadataRecords PaymentMetadata[]

  @@index([userId])
  @@index([tenantId])
  @@index([status])
  @@index([isArchived])
  @@index([createdDate])
  @@unique([tenantId, transactionId], map: "uq_payment_tenant_transaction")
  @@map("Payment")
}

model PaymentMetadata {
  id        String   @id @default(uuid())
  paymentId String
  key       String
  value     Json     @default("null")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  payment Payment @relation(fields: [paymentId], references: [id], onDelete: Cascade)

  @@index([paymentId], map: "idx_payment_metadata_payment")
  @@unique([paymentId, key], map: "uq_payment_metadata_key")
  @@map("PaymentMetadata")
}

model Platform {
  id          String    @id @default(uuid())
  picture     String?
  title       String
  description String?
  releaseDate DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  @@map("Platform")
}

model Prefix {
  id        String   @id @default(uuid())
  guildId   String   @unique
  prefix    String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("Prefix")
}

model Product {
  id                String   @id @default(uuid())
  picture           String?
  title             String
  shortDescription  String
  detailDescription String   @default("") @db.Text
  price             Decimal  @db.Decimal(18, 2)
  category          String   @default("")
  stock             Int      @default(0)
  sku               String?
  currency          String   @default("USD")
  tenantId          String?
  isArchived        Boolean  @default(false)
  deletedAt         DateTime?
  metadata          Json     @default("{}")
  createdDate       DateTime @default(now())
  updatedDate       DateTime @updatedAt

  tenant Tenant? @relation(fields: [tenantId], references: [id], onDelete: SetNull)

  @@index([tenantId])
  @@index([category])
  @@index([isArchived])
  @@index([createdDate])
  @@unique([tenantId, sku], map: "uq_product_tenant_sku")
  @@map("Product")
}

model Project {
  id                String        @id @default(uuid())
  picture           String?
  title             String
  shortDescription  String
  detailDescription String        @default("") @db.Text
  status            ProjectStatus @default(NOT_STARTED)
  startDate         DateTime      @default(now())
  endDate           DateTime?
  members           Json          @default("[]")
  tags              Json          @default("[]")
  tenantId          String?
  isArchived        Boolean       @default(false)
  deletedAt         DateTime?
  metadata          Json          @default("{}")
  createdDate       DateTime      @default(now())
  updatedAt         DateTime      @updatedAt

  blogs    Blog[]
  bugs     Bug[]
  features Feature[]
  issues   Issue[]
  stories  Story[]
  tenant   Tenant?  @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  memberRecords ProjectMember[]
  tagRecords    ProjectTag[]
  metadataRecords ProjectMetadata[]

  @@index([status])
  @@index([tenantId])
  @@index([isArchived])
  @@index([createdDate])
  @@unique([tenantId, title], map: "uq_project_tenant_title")
  @@map("Project")
}

model ProjectMetadata {
  id        String   @id @default(uuid())
  projectId String
  key       String
  value     Json     @default("null")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId], map: "idx_project_metadata_project")
  @@unique([projectId, key], map: "uq_project_metadata_key")
  @@map("ProjectMetadata")
}

model ProjectMember {
  id         String   @id @default(uuid())
  projectId  String
  userId     String
  role       String?  @default("contributor")
  joinedAt   DateTime @default(now())
  leftAt     DateTime?
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
  user    User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  historyRecords ProjectMemberHistory[]

  @@index([projectId], map: "idx_project_member_project")
  @@index([userId], map: "idx_project_member_user")
  @@unique([projectId, userId], map: "uq_project_member_user")
  @@map("ProjectMember")
}

model ProjectMemberHistory {
  id            String              @id @default(uuid())
  projectMemberId String
  eventType     MembershipEventType @default(ADDED)
  actorId       String?
  description   String?             @db.Text
  occurredAt    DateTime            @default(now())
  createdAt     DateTime            @default(now())

  projectMember ProjectMember @relation(fields: [projectMemberId], references: [id], onDelete: Cascade)
  actor         User?         @relation("ProjectMemberHistoryActor", fields: [actorId], references: [id], onDelete: SetNull)

  @@index([projectMemberId], map: "idx_project_member_history_parent")
  @@index([actorId], map: "idx_project_member_history_actor")
  @@map("ProjectMemberHistory")
}

model ProjectTag {
  id        String @id @default(uuid())
  projectId String
  tagId     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
  tag     Tag     @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@index([projectId], map: "idx_project_tag_project")
  @@index([tagId], map: "idx_project_tag_tag")
  @@unique([projectId, tagId], map: "uq_project_tag_tag")
  @@map("ProjectTag")
}

model Report {
  id             String   @id @default(uuid())
  userId         String
  guildId        String
  reportedUserId String
  reason         String   @db.Text
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@index([guildId])
  @@index([createdAt])
  @@map("Report")
}

model Return {
  id           String       @id @default(uuid())
  orderId      String
  returnNumber String       @unique
  returnDate   DateTime     @default(now())
  reason       String
  status       ReturnStatus @default(REQUESTED)
  items        Json         @default("[]")
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt

  order CustomerOrder @relation(fields: [orderId], references: [id], onDelete: Cascade)
  itemRecords ReturnItem[]

  @@index([orderId])
  @@index([status])
  @@index([createdAt])
  @@map("Return")
}

model ReturnItem {
  id        String   @id @default(uuid())
  returnId  String
  productId String
  quantity  Int      @default(1)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  returnRecord Return        @relation(fields: [returnId], references: [id], onDelete: Cascade)
  product      Product       @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([returnId], map: "idx_return_item_return")
  @@index([productId], map: "idx_return_item_product")
  @@unique([returnId, productId], map: "uq_return_item_product")
  @@map("ReturnItem")
}

model Role {
  id          String   @id @default(uuid())
  name        String   @unique
  displayName String
  color       String   @default("#000000")
  description String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("Role")
}

model Roleplay {
  id               String   @id @default(uuid())
  userId           String   @unique
  characterName    String
  characterLevel   Int      @default(1)
  experiencePoints Int      @default(0)
  lastRoleplayDate DateTime @default(now())
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  @@map("Roleplay")
}

model Share {
  id        String        @id @default(uuid())
  userId    String
  blogId    String
  platform  SharePlatform
  createdAt DateTime      @default(now())
  updatedAt DateTime      @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  blog Blog @relation(fields: [blogId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([blogId])
  @@index([createdAt])
  @@map("Share")
}

model Slowmode {
  id        String   @id @default(uuid())
  channelId String   @unique
  duration  Int
  setBy     String
  setAt     DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("Slowmode")
}

model Story {
  id          String        @id @default(uuid())
  title       String
  description String        @db.Text
  status      StoryStatus   @default(BACKLOG)
  priority    PriorityLevel @default(MEDIUM)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  projectId   String

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId])
  @@index([status])
  @@index([priority])
  @@index([createdAt])
  @@map("Story")
}

model Subscriber {
  id           String   @id @default(uuid())
  email        String   @unique
  name         String?
  subscribedAt DateTime @default(now())
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@map("Subscriber")
}

model Tag {
  id          String   @id @default(uuid())
  name        String   @unique
  description String   @default("")
  createdDate DateTime @default(now())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("Tag")
}

model Task {
  id           String       @id @default(uuid())
  title        String
  description  String       @default("") @db.Text
  category     TaskCategory @default(OTHER)
  status       TaskStatus   @default(PENDING)
  assignedToId String
  teamId       String
  dueDate      DateTime?
  tenantId     String?
  priority     PriorityLevel @default(MEDIUM)
  estimateHours Decimal?     @db.Decimal(10, 2)
  isArchived   Boolean       @default(false)
  deletedAt    DateTime?
  metadata     Json          @default("{}")
  createdDate  DateTime     @default(now())
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt

  assignedTo User @relation("TaskAssignee", fields: [assignedToId], references: [id], onDelete: Cascade)
  team       Team @relation(fields: [teamId], references: [id], onDelete: Cascade)
  tenant     Tenant? @relation(fields: [tenantId], references: [id], onDelete: SetNull)

  @@index([assignedToId])
  @@index([teamId])
  @@index([tenantId])
  @@index([status])
  @@index([priority])
  @@index([dueDate])
  @@index([createdAt])
  @@index([isArchived])
  @@unique([teamId, title, assignedToId], map: "uq_task_team_title_assignee")
  @@map("Task")
}

model Team {
  id          String     @id @default(uuid())
  name        String
  description String     @default("") @db.Text
  createdDate DateTime   @default(now())
  members     Json       @default("[]")
  status      TeamStatus @default(ACTIVE)
  type        TeamType   @default(OTHER)
  logo        String     @default("default-team-logo.png")
  ownerId     String?
  tenantId    String?
  isArchived  Boolean    @default(false)
  deletedAt   DateTime?
  metadata    Json       @default("{}")
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  owner User? @relation("TeamOwner", fields: [ownerId], references: [id], onDelete: SetNull)
  tenant Tenant? @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  tasks  Task[]
  memberRecords TeamMember[]
  metadataRecords TeamMetadata[]

  @@index([tenantId])
  @@index([ownerId])
  @@index([isArchived])
  @@index([createdDate])
  @@unique([tenantId, name], map: "uq_team_tenant_name")
  @@map("Team")
}

model TeamMetadata {
  id      String   @id @default(uuid())
  teamId  String
  key     String
  value   Json     @default("null")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  team Team @relation(fields: [teamId], references: [id], onDelete: Cascade)

  @@index([teamId], map: "idx_team_metadata_team")
  @@unique([teamId, key], map: "uq_team_metadata_key")
  @@map("TeamMetadata")
}

model TeamMember {
  id        String   @id @default(uuid())
  teamId    String
  userId    String
  role      String?  @default("member")
  joinedAt  DateTime @default(now())
  leftAt    DateTime?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  team Team @relation(fields: [teamId], references: [id], onDelete: Cascade)
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  historyRecords TeamMemberHistory[]

  @@index([teamId], map: "idx_team_member_team")
  @@index([userId], map: "idx_team_member_user")
  @@unique([teamId, userId], map: "uq_team_member_user")
  @@map("TeamMember")
}

model TeamMemberHistory {
  id           String              @id @default(uuid())
  teamMemberId String
  eventType    MembershipEventType @default(ADDED)
  actorId      String?
  description  String?             @db.Text
  occurredAt   DateTime            @default(now())
  createdAt    DateTime            @default(now())

  teamMember TeamMember @relation(fields: [teamMemberId], references: [id], onDelete: Cascade)
  actor      User?      @relation("TeamMemberHistoryActor", fields: [actorId], references: [id], onDelete: SetNull)

  @@index([teamMemberId], map: "idx_team_member_history_parent")
  @@index([actorId], map: "idx_team_member_history_actor")
  @@map("TeamMemberHistory")
}

model Ticket {
  id          String       @id @default(uuid())
  guildId     String
  userId      String
  title       String
  description String       @default("No description provided") @db.Text
  status      TicketStatus @default(OPEN)
  messages    Json         @default("[]")
  tenantId    String?
  assignedToId String?
  priority    PriorityLevel @default(MEDIUM)
  category    String?
  slaDueAt    DateTime?
  isArchived  Boolean       @default(false)
  deletedAt   DateTime?
  metadata    Json          @default("{}")
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt

  assignedTo User?           @relation(fields: [assignedToId], references: [id], onDelete: SetNull)
  tenant     Tenant?         @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  responses  TicketResponse[]
  messageRecords TicketMessage[]
  metadataRecords TicketMetadata[]

  @@index([guildId])
  @@index([userId])
  @@index([tenantId])
  @@index([assignedToId])
  @@index([status])
  @@index([priority])
  @@index([isArchived])
  @@index([createdAt])
  @@index([tenantId, status], map: "idx_ticket_tenant_status")
  @@map("Ticket")
}

model TicketMetadata {
  id       String   @id @default(uuid())
  ticketId String
  key      String
  value    Json     @default("null")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  ticket Ticket @relation(fields: [ticketId], references: [id], onDelete: Cascade)

  @@index([ticketId], map: "idx_ticket_metadata_ticket")
  @@unique([ticketId, key], map: "uq_ticket_metadata_key")
  @@map("TicketMetadata")
}

model TicketMessage {
  id         String   @id @default(uuid())
  ticketId   String
  messageId  String   @unique
  authorId   String
  content    String   @db.Text
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  ticket Ticket @relation(fields: [ticketId], references: [id], onDelete: Cascade)
  author User?  @relation("TicketMessageAuthor", fields: [authorId], references: [id], onDelete: SetNull)

  @@index([ticketId], map: "idx_ticket_message_ticket")
  @@index([authorId], map: "idx_ticket_message_author")
  @@map("TicketMessage")
}

model TicketResponse {
  id        String   @id @default(uuid())
  ticketId  String
  userId    String
  response  String   @db.Text
  metadata  Json     @default("{}")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  ticket Ticket @relation(fields: [ticketId], references: [id], onDelete: Cascade)
  metadataRecords TicketResponseMetadata[]

  @@index([ticketId])
  @@index([userId])
  @@index([createdAt])
  @@map("TicketResponse")
}

model TicketResponseMetadata {
  id              String   @id @default(uuid())
  ticketResponseId String
  key             String
  value           Json     @default("null")
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  ticketResponse TicketResponse @relation(fields: [ticketResponseId], references: [id], onDelete: Cascade)

  @@index([ticketResponseId], map: "idx_ticket_response_metadata_parent")
  @@unique([ticketResponseId, key], map: "uq_ticket_response_metadata_key")
  @@map("TicketResponseMetadata")
}

model Timeout {
  id        String   @id @default(uuid())
  userId    String
  username  String
  guildId   String
  reason    String
  duration  Int
  timeoutAt DateTime @default(now())
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([guildId])
  @@map("Timeout")
}

model TriviaAnswer {
  id         String   @id @default(uuid())
  userId     String
  questionId String
  answer     String
  correct    Boolean
  answeredAt DateTime @default(now())
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  question TriviaQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@index([questionId])
  @@map("TriviaAnswer")
}

model TriviaQuestion {
  id            String   @id @default(uuid())
  question      String   @db.Text
  options       Json     @default("[]")
  correctAnswer String
  category      String
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  answers TriviaAnswer[]
  optionRecords TriviaQuestionOption[]

  @@map("TriviaQuestion")
}

model TriviaQuestionOption {
  id          String   @id @default(uuid())
  questionId  String
  value       String
  isCorrect   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  question TriviaQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@index([questionId], map: "idx_trivia_option_question")
  @@unique([questionId, value], map: "uq_trivia_option_value")
  @@map("TriviaQuestionOption")
}

model TriviaStats {
  id               String   @id @default(uuid())
  userId           String   @unique
  correctAnswers   Int      @default(0)
  incorrectAnswers Int      @default(0)
  totalQuestions   Int      @default(0)
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  @@map("TriviaStats")
}

model User {
  id                       String    @id @default(uuid())
  profilePicture           String?
  fullname                 String
  username                 String    @unique
  email                    String    @unique
  password                 String?
  role                     UserRole  @default(USER)
  bio                      String    @default("") @db.Text
  recentActivity           DateTime  @default(now())
  lastLoginAt              DateTime?
  inactiveSince            DateTime?
  verificationToken        String    @default("")
  verificationTokenExpires DateTime?
  isVerified               Boolean   @default(false)
  isAuthenticated          Boolean   @default(false)
  accessToken              String?
  refreshToken             String?
  apiKeyId                 String?   @map("apiKey")
  betaKeyId                String?   @map("betaKey")
  isBetaTester             Boolean   @default(false)
  termsAccepted            Boolean   @default(false)
  termsAcceptedAt          DateTime?
  tenantId                 String?
  passwordChangedAt        DateTime?
  loginAttempts            Int       @default(0)
  mfaEnabled               Boolean   @default(false)
  createdAt                DateTime  @default(now())
  updatedAt                DateTime  @updatedAt

  addressRecord        UserAddress?
  phoneNumberRecords   UserPhoneNumber[]
  paymentMethodRecords UserPaymentMethod[]
  sessionRecords       UserSession[]
  socialLinkRecords    UserSocialLink[]
  oauthProviderRecords UserOAuthProvider[]
  postRecords          UserPost[]
  portfolioProjects    UserPortfolioProject[]
  followerRelations    UserFriend[]        @relation("UserFollowerRelations")
  followingRelations   UserFriend[]        @relation("UserFollowingRelations")
  organizationMemberships OrganizationMember[]
  teamMemberships         TeamMember[]
  groupMemberships        GroupMember[]
  projectMemberships      ProjectMember[]
  chatParticipantRecords  ChatParticipant[] @relation("ChatParticipantUser")
  ticketMessages          TicketMessage[] @relation("TicketMessageAuthor")
  gameRatings             GameRating[] @relation("GameRatingUser")
  versionContributions    VersionDeveloper[] @relation("VersionDeveloperUser")
  teamMemberHistoryEvents TeamMemberHistory[] @relation("TeamMemberHistoryActor")
  projectMemberHistoryEvents ProjectMemberHistory[] @relation("ProjectMemberHistoryActor")
  organizationMemberHistoryEvents OrganizationMemberHistory[] @relation("OrganizationMemberHistoryActor")
  groupMemberHistoryEvents GroupMemberHistory[] @relation("GroupMemberHistoryActor")

  apiKeys           ApiKey[]           @relation("UserApiKeys")
  betaKeys          BetaKey[]          @relation("UserBetaKeys")
  primaryApiKey     ApiKey?            @relation("UserPrimaryApiKey", fields: [apiKeyId], references: [id], onDelete: SetNull)
  primaryBetaKey    BetaKey?           @relation("UserPrimaryBetaKey", fields: [betaKeyId], references: [id], onDelete: SetNull)
  balance           Balance?
  developerPrograms DeveloperProgram[]
  favorites         Favorite[]
  likes             Like[]
  dislikes          Dislike[]
  shares            Share[]
  comments          Comment[]
  payments          Payment[]
  tasksAssigned     Task[]             @relation("TaskAssignee")
  tenant            Tenant?            @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  auditLogs         AuditLog[]         @relation("UserAuditLogs")
  teamsOwned        Team[]             @relation("TeamOwner")

  @@index([email], map: "idx_user_email")
  @@index([tenantId])
  @@index([role])
  @@index([createdAt])
  @@index([lastLoginAt])
  @@map("User")
}

model UserAddress {
  id          String   @id @default(uuid())
  userId      String   @unique
  street      String   @default("")
  houseNumber String   @default("")
  state       String   @default("")
  postcode    String   @default("")
  country     String   @default("")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("UserAddress")
}

model UserPhoneNumber {
  id        String           @id @default(uuid())
  userId    String
  type      PhoneNumberType
  number    String           @default("")
  createdAt DateTime         @default(now())
  updatedAt DateTime         @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId], map: "idx_user_phone_user")
  @@unique([userId, type], map: "uq_user_phone_type")
  @@map("UserPhoneNumber")
}

model UserPaymentMethod {
  id        String                @id @default(uuid())
  userId    String
  method    UserPaymentMethodType
  metadata  Json                  @default("{}")
  createdAt DateTime              @default(now())
  updatedAt DateTime              @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId], map: "idx_user_payment_user")
  @@unique([userId, method], map: "uq_user_payment_method")
  @@map("UserPaymentMethod")
}

model UserSession {
  id        String   @id @default(uuid())
  userId    String
  browser   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId], map: "idx_user_session_user")
  @@map("UserSession")
}

model UserSocialLink {
  id        String         @id @default(uuid())
  userId    String
  type      SocialLinkType
  url       String         @default("")
  createdAt DateTime       @default(now())
  updatedAt DateTime       @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId], map: "idx_user_social_user")
  @@unique([userId, type], map: "uq_user_social_type")
  @@map("UserSocialLink")
}

model UserOAuthProvider {
  id              String        @id @default(uuid())
  userId          String
  provider        OAuthProvider
  providerUserId  String        @default("")
  accessToken     String        @default("")
  refreshToken    String        @default("")
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId], map: "idx_user_oauth_user")
  @@unique([userId, provider], map: "uq_user_oauth_provider")
  @@map("UserOAuthProvider")
}

model UserPost {
  id          String   @id @default(uuid())
  userId      String
  picture     String   @default("")
  title       String
  description String   @db.Text
  author      String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  tags UserPostTag[]

  @@index([userId], map: "idx_user_post_user")
  @@index([createdAt], map: "idx_user_post_created")
  @@map("UserPost")
}

model UserPostTag {
  id      String   @id @default(uuid())
  postId  String
  value   String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  post UserPost @relation(fields: [postId], references: [id], onDelete: Cascade)

  @@index([postId], map: "idx_user_post_tag_post")
  @@unique([postId, value], map: "uq_user_post_tag_value")
  @@map("UserPostTag")
}

model UserPortfolioProject {
  id                 String   @id @default(uuid())
  userId             String
  picture            String   @default("")
  title              String
  shortDescription   String
  description        String   @db.Text
  developer          String
  publishedAt        DateTime @default(now())
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  features UserPortfolioProjectFeature[]
  services UserPortfolioProjectService[]
  supportedPlatforms UserPortfolioProjectPlatform[]
  versions UserPortfolioProjectVersion[]

  @@index([userId], map: "idx_user_portfolio_user")
  @@map("UserPortfolioProject")
}

model UserPortfolioProjectFeature {
  id         String   @id @default(uuid())
  projectId  String
  value      String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  project UserPortfolioProject @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId], map: "idx_user_portfolio_feature_project")
  @@unique([projectId, value], map: "uq_user_portfolio_feature")
  @@map("UserPortfolioProjectFeature")
}

model UserPortfolioProjectService {
  id         String   @id @default(uuid())
  projectId  String
  value      String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  project UserPortfolioProject @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId], map: "idx_user_portfolio_service_project")
  @@unique([projectId, value], map: "uq_user_portfolio_service")
  @@map("UserPortfolioProjectService")
}

model UserPortfolioProjectPlatform {
  id         String   @id @default(uuid())
  projectId  String
  value      String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  project UserPortfolioProject @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId], map: "idx_user_portfolio_platform_project")
  @@unique([projectId, value], map: "uq_user_portfolio_platform")
  @@map("UserPortfolioProjectPlatform")
}

model UserPortfolioProjectVersion {
  id         String   @id @default(uuid())
  projectId  String
  value      String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  project UserPortfolioProject @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([projectId], map: "idx_user_portfolio_version_project")
  @@unique([projectId, value], map: "uq_user_portfolio_version")
  @@map("UserPortfolioProjectVersion")
}

model UserFriend {
  id          String   @id @default(uuid())
  followerId  String
  followedId  String
  followedAt  DateTime @default(now())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  follower User @relation("UserFollowerRelations", fields: [followerId], references: [id], onDelete: Cascade)
  followed User @relation("UserFollowingRelations", fields: [followedId], references: [id], onDelete: Cascade)

  @@index([followerId], map: "idx_user_friend_follower")
  @@index([followedId], map: "idx_user_friend_followed")
  @@unique([followerId, followedId], map: "uq_user_friend_pair")
  @@map("UserFriend")
}

model Version {
  id                String   @id @default(uuid())
  picture           String   @default("")
  title             String
  shortDescription  String
  detailDescription String   @db.Text
  versionTagId      String
  features          Json     @default("[]")
  added             Json     @default("[]")
  fixed             Json     @default("[]")
  bugs              Json     @default("[]")
  developers        Json     @default("[]")
  githublink        String   @default("")
  downloadLink      String
  releasedAt        DateTime
  tenantId          String?
  isArchived        Boolean  @default(false)
  deletedAt         DateTime?
  metadata          Json     @default("{}")
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  versionTag VersionTag @relation(fields: [versionTagId], references: [id], onDelete: Cascade)
  tenant     Tenant?    @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  featureRecords   VersionFeature[]
  additionRecords  VersionAddition[]
  fixRecords       VersionFix[]
  bugRecords       VersionBugRecord[]
  developerRecords VersionDeveloper[]
  metadataRecords  VersionMetadata[]

  @@index([versionTagId])
  @@index([tenantId])
  @@index([releasedAt])
  @@index([createdAt])
  @@index([isArchived])
  @@unique([tenantId, title, versionTagId], map: "uq_version_tenant_title_tag")
  @@map("Version")
}

model VersionFeature {
  id        String   @id @default(uuid())
  versionId String
  value     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  version Version @relation(fields: [versionId], references: [id], onDelete: Cascade)

  @@index([versionId], map: "idx_version_feature_version")
  @@unique([versionId, value], map: "uq_version_feature_value")
  @@map("VersionFeature")
}

model VersionAddition {
  id        String   @id @default(uuid())
  versionId String
  value     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  version Version @relation(fields: [versionId], references: [id], onDelete: Cascade)

  @@index([versionId], map: "idx_version_addition_version")
  @@unique([versionId, value], map: "uq_version_addition_value")
  @@map("VersionAddition")
}

model VersionFix {
  id        String   @id @default(uuid())
  versionId String
  value     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  version Version @relation(fields: [versionId], references: [id], onDelete: Cascade)

  @@index([versionId], map: "idx_version_fix_version")
  @@unique([versionId, value], map: "uq_version_fix_value")
  @@map("VersionFix")
}

model VersionBugRecord {
  id        String   @id @default(uuid())
  versionId String
  value     String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  version Version @relation(fields: [versionId], references: [id], onDelete: Cascade)

  @@index([versionId], map: "idx_version_bug_version")
  @@unique([versionId, value], map: "uq_version_bug_value")
  @@map("VersionBugRecord")
}

model VersionDeveloper {
  id        String   @id @default(uuid())
  versionId String
  userId    String?
  name      String   @default("")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  version Version @relation(fields: [versionId], references: [id], onDelete: Cascade)
  user    User?    @relation("VersionDeveloperUser", fields: [userId], references: [id], onDelete: SetNull)

  @@index([versionId], map: "idx_version_developer_version")
  @@index([userId], map: "idx_version_developer_user")
  @@unique([versionId, name], map: "uq_version_developer_name")
  @@map("VersionDeveloper")
}

model VersionMetadata {
  id        String   @id @default(uuid())
  versionId String
  key       String
  value     Json     @default("null")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  version Version @relation(fields: [versionId], references: [id], onDelete: Cascade)

  @@index([versionId], map: "idx_version_metadata_version")
  @@unique([versionId, key], map: "uq_version_metadata_key")
  @@map("VersionMetadata")
}

model VersionTag {
  id          String   @id @default(uuid())
  title       String
  description String   @db.Text
  tenantId    String?
  isArchived  Boolean  @default(false)
  metadata    Json     @default("{}")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  tenant   Tenant?  @relation(fields: [tenantId], references: [id], onDelete: SetNull)
  versions Version[]
  metadataRecords VersionTagMetadata[]

  @@index([tenantId])
  @@index([isArchived])
  @@unique([tenantId, title], map: "uq_version_tag_tenant_title")
  @@map("VersionTag")
}

model VersionTagMetadata {
  id          String   @id @default(uuid())
  versionTagId String
  key         String
  value       Json     @default("null")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  versionTag VersionTag @relation(fields: [versionTagId], references: [id], onDelete: Cascade)

  @@index([versionTagId], map: "idx_version_tag_metadata_parent")
  @@unique([versionTagId, key], map: "uq_version_tag_metadata_key")
  @@map("VersionTagMetadata")
}

model Warn {
  id          String   @id @default(uuid())
  guildId     String
  userId      String
  moderatorId String
  reason      String   @db.Text
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([guildId])
  @@map("Warn")
}

model Word {
  id        String   @id @default(uuid())
  guildId   String
  word      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([guildId])
  @@map("Word")
}
