<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Account Settings ~ NodCord</title>
  <link rel="shortcut icon" href="<%= logoImage %>" type="image/x-icon">
  <link rel="stylesheet" href="assets/css/styles.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css" />
  <link rel="stylesheet" href="https://unpkg.com/@merakiui/merakiui/dist/merakiui.min.css" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-900 dark:bg-gray-800 dark:text-gray-200">
  <%- include('../partials/header'); %>

  <main class="max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
    <h1 class="text-3xl font-bold mb-8">Account Settings</h1>

    <form action="<%= api.https %>://<%= api.baseURL %>:<%= api.port %>/api/user/profile/settings" method="POST" class="space-y-6">
      <div>
        <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-200">Email Address</label>
        <input type="email" name="email" id="email" class="text-gray-900 mt-1 p-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" value="<%= user.email %>" required>
        <% if (!user.isVerified) { %>
          <p class="text-sm text-red-600 mt-2">Your email is not verified. <a href="/user/profile/${user.username}/send-verification" class="text-blue-600 hover:underline">Send verification email</a>.</p>
        <% } %>
      </div>

      <div>
        <label for="fullname" class="block text-sm font-medium text-gray-700 dark:text-gray-200">Full Name</label>
        <input type="text" name="fullname" id="fullname" class="text-gray-900 mt-1 p-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" value="<%= user.fullname %>" required>
      </div>

      <div>
        <label for="username" class="block text-sm font-medium text-gray-700 dark:text-gray-200">Username</label>
        <input type="text" name="username" id="username" class="text-gray-900 mt-1 p-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500" value="<%= user.username %>" required>
      </div>

      <div>
        <label for="password" class="block text-sm font-medium text-gray-700 dark:text-gray-200">Password</label>
        <input type="password" name="password" id="password" class="text-gray-900 mt-1 p-2 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500">
        <p class="text-sm text-gray-500 mt-1">Leave blank to keep your current password.</p>
      </div>

      <div class="mt-6">
        <h2 class="text-xl font-semibold text-gray-800 dark:text-gray-200 mb-4">Manage Sessions</h2>
        <a href="/user/profile/logout-all-sessions" class="text-blue-600 hover:underline">Log out from all sessions</a>
      </div>

      <div class="mt-6">
        <h2 class="text-xl font-semibold text-red-600 mb-4">Danger Zone</h2>
        <button type="button" class="bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700" onclick="document.getElementById('deleteAccountForm').submit()">Delete Account</button>
      </div>

      <input type="hidden" name="_method" value="DELETE">
    </form>

    <form id="deleteAccountForm" action="<%= api.https %>://<%= api.baseURL %>:<%= api.port %>/api/user/profile/delete-account" method="POST">
      <input type="hidden" name="_method" value="DELETE">
    </form>
  </main>

  <%- include('../partials/footer'); %>
</body>
</html>
